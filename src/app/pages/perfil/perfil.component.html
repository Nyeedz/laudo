<div class="wrapper">
  <div class="profile-box">
    <div class="picture">
      <img
        [src]="
          avatar !== null
            ? 'http://localhost:1337' + avatar
            : 'assets/avatar.svg'
        "
        alt=""
      />
      <button mat-raised-button color="primary" (click)="avatarChange()">
        Trocar foto de perfil
      </button>
    </div>
    <form [formGroup]="form" class="forms">
      <mat-form-field class="mat-form-field">
        <input
          formControlName="username"
          matInput
          placeholder="Username"
          required
        />
        <mat-error *ngIf="form?.hasError('required', 'username')"
          >Username é obrigatório</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input formControlName="nome" matInput placeholder="Nome" required />
        <mat-error *ngIf="form?.hasError('required', 'nome')"
          >E-mail é obrigatório</mat-error
        >
        <mat-error *ngIf="firstForm?.hasError('nome', 'nome')"
          >Formato de e-mail errado</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input formControlName="email" matInput placeholder="E-mail" />
        <mat-error *ngIf="form?.hasError('required', 'email')"
          >E-mail é obrigatório</mat-error
        >
        <mat-error *ngIf="firstForm?.hasError('email', 'email')"
          >Formato de e-mail errado</mat-error
        >
      </mat-form-field>

      <mat-form-field>
        <input
          matInput
          placeholder="Cep"
          formControlName="cep"
          required
          (blur)="consultaCep($event.target.value)"
        />
        <mat-error *ngIf="form?.hasError('required', 'cep')"
          >Cep é obrigatório</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input
          formControlName="endereco"
          matInput
          placeholder="Endereço"
          required
        />
        <mat-error *ngIf="form?.hasError('required', 'endereco')"
          >Endereço é obrigatório</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input
          formControlName="bairro"
          matInput
          placeholder="Bairro"
          required
        />
        <mat-error *ngIf="form?.hasError('required', 'bairro')"
          >Bairro é obrigatório</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input
          formControlName="cidade"
          matInput
          placeholder="Cidade"
          required
        />
        <mat-error *ngIf="form?.hasError('required', 'cidade')"
          >Cidade é obrigatório</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input
          formControlName="estado"
          matInput
          placeholder="Estado"
          required
        />
        <mat-error *ngIf="form?.hasError('required', 'estado')"
          >estado é obrigatório</mat-error
        >
      </mat-form-field>

      <mat-form-field class="mat-form-field">
        <input
          formControlName="numero"
          matInput
          placeholder="Número"
          required
        />
        <mat-error *ngIf="form?.hasError('required', 'numero')"
          >Número é obrigatório</mat-error
        >
      </mat-form-field>

      <button
        mat-flat-button
        color="primary"
        [disabled]="form.invalid"
        (click)="save()"
      >
        Salvar
      </button>
    </form>
    <div class="companies">
      <mat-form-field>
        <mat-label>Selecione suas empresas</mat-label>
        <mat-select
          (selectionChange)="change($event.value)"
          [(value)]="selected"
        >
          <mat-option value="credenciada">Empresas Credenciadas</mat-option>
          <mat-option value="contratante">Empresas Contratantes</mat-option>
        </mat-select>
      </mat-form-field>

      <!-- verificar primeiro se n tem item na lista -->
      <h4 *ngIf="credenciadaShow && credenciada.length === 0" mat-line>
        Não possuí empresa credenciada
      </h4>

      <h4 *ngIf="contratanteShow && contratante.length === 0" mat-line>
        Não possuí empresa contratante
      </h4>

      <mat-list role="list" *ngFor="let empresacres of credenciada">
        <mat-list-item *ngIf="credenciadaShow" role="listitem">
          <h4 mat-line>
            {{ empresacres.nome_fantasia }}
          </h4>
          <p mat-line>{{ empresacres.updatedAt | date }}</p>
        </mat-list-item>
      </mat-list>
      <mat-list role="list" *ngFor="let empresacons of contratante">
        <mat-list-item *ngIf="contratanteShow" role="listitem">
          <h4 mat-line>{{ empresacons.nome_fantasia }}</h4>
          <p mat-line>{{ empresacons.updatedAt | date }}</p>
        </mat-list-item>
      </mat-list>
    </div>
  </div>
</div>
